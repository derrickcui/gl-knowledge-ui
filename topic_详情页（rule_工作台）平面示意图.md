# Topic 详情页（Rule 工作台）— 完整平面示意图

> 本示意图用于：
> - 产品定型
> - 前端 / 设计对齐
> - 后端 API 对齐

不涉及代码，仅定义**页面结构、区域职责、交互语义**。

---

## 一、页面整体结构（一眼全局）

```
┌───────────────────────────────────────────────────────────────────────────┐
│ ← Topics            Topic：博士后支持政策        Status：DRAFT             │
│                    描述：用于识别博士后相关支持政策                         │
└───────────────────────────────────────────────────────────────────────────┘

┌───────────────┬──────────────────────────────────────┬───────────────────┐
│ 左：构件区     │ 中：规则编排区（Rule Builder）        │ 右：解释 / 预览区 │
│               │                                      │                   │
│ 【概念】      │  当前规则树（AST 可视化）              │  Explain Preview  │
│  - 搜索概念    │                                      │  ───────────────  │
│               │  <Accrue  阈值 0.7>                    │  规则说明：       │
│ 【关系】      │   ├─ 博士后优惠 (权重 1.0)             │  • 命中博士后优惠 │
│  - 含下位      │   └─ 人才政策 (含下位, 权重 0.6)      │  • 下位概念命中   │
│               │                                      │                   │
│ 【文本条件】  │  [+ 添加条件]                          │  只读 GQL：       │
│  - 包含        │                                      │  <accrue>(...)    │
│  - 近邻        │                                      │                   │
│               │                                      │  [试运行 Explain] │
│ 【语义字段】  │                                      │                   │
│  - 文档正文    │                                      │                   │
│  - 标题        │                                      │                   │
└───────────────┴──────────────────────────────────────┴───────────────────┘

┌───────────────────────────────────────────────────────────────────────────┐
│ [ 保存 Draft ]   [ 校验规则 ]   [ 发布 Topic ]                              │
└───────────────────────────────────────────────────────────────────────────┘
```

---

## 二、顶部区域（Topic 资产头部）

### 职责
- 明确：我现在在编辑 **哪个 Topic**
- 明确：**是否可用（状态）**

### 展示元素
```
Topic 名称：博士后支持政策
描述：用于识别博士后相关支持政策
状态：DRAFT | PUBLISHED
```

📌 行为规则：
- 状态为 PUBLISHED → 禁止直接编辑规则（需进入新 Draft）

---

## 三、左侧：规则构件区（Operator Palette）

### 职责
> 提供“可用规则能力”，而不是自由输入

### 构件分类（与你 GQL 能力一一对应）

```
【概念】
- 🔍 搜索知识库（Concept Search）

【关系】
- 仅当前概念
- 包含下位概念（Descendant）

【文本条件】
- 包含关键词
- 短语
- 近邻 / 句内

【语义字段】
- 文档正文
- 标题
- 标签
```

📌 原则：
- 运营人员永远看不到“字段名”
- 所有构件都映射为 RuleNode 类型

---

## 四、中间：规则编排区（Rule Builder 核心）

### 职责
> 将规则表达为一棵 **语义规则树（AST）**

### 示例结构

```
<Accrue  threshold=0.7>
 ├─ Concept：博士后优惠   weight=1.0
 └─ Concept：人才政策     relation=DESCENDANT  weight=0.6
```

### 支持操作
- 添加子规则
- 调整权重
- 拖拽顺序
- 删除节点

📌 UI 操作 ≠ GQL 操作

---

## 五、右侧：Explain / 预览区（信任建立区）

### 职责
> 回答两个问题：
> 1. 这个规则“在干什么”
> 2. 为什么它会命中

### 内容区块

```
【自然语言解释】
- 命中博士后科研资助
- 该概念属于 博士后优惠 的下位概念

【只读 GQL】
<accrue>(<any>(博士后优惠), <descendant_of>(人才政策))

【试运行】
[ 选择样本文档 ] → [ Explain ]
```

📌 规则：
- GQL 永远只读
- Explain 来源于 RuleNode

---

## 六、底部操作区（生命周期控制）

### 按钮行为

| 按钮 | 行为 |
|----|----|
| 保存 Draft | 仅保存，不校验 |
| 校验规则 | 检查结构 / Concept 状态 |
| 发布 Topic | Compile → Runtime Cache |

📌 发布是唯一生效入口

---

## 七、这个页面为什么“刚刚好”

- Topic 是资产
- Rule 是内容
- Concept 是知识
- GQL 是实现

👉 用户只在“语义层”操作

---

## 八、自然延展（你现在不用做）

- Topic 版本对比
- Topic 模板
- 命中统计

这些都不会破坏当前设计。

---

如果你愿意，下一步我可以继续画：
1️⃣ Topic 列表页（完整态）
2️⃣ TopicSet 编排页
3️⃣ Dataset Binding / 部署页

